(this.webpackJsonp=this.webpackJsonp||[]).push([[14],{"/6uHU+qu":function(t,e,o){"use strict";var r=o("q1tIBJhx"),n=o.n(r),i=o("TSYQbtd+"),a=o.n(i),s=o("GESwhXbR"),c=o("9l7jY84A"),l=o("DfGQzvyE"),p=o.n(l),u=function(t){return n.a.createElement(c.a,{className:a()(p.a["create-card"],t.className),onClick:t.onClick},n.a.createElement(s.Icon,{name:"plus-s",className:"create-card__plus"}),n.a.createElement("div",{className:"base-card__content"},n.a.createElement("div",{className:"base-card__name"},t.name),n.a.createElement("div",{className:"base-card__desc"},t.description)))},d=o("tLZJUYWX"),h=o.n(d),m=o("a+N5u/Cl"),g=o.n(m),f=o("XPhJD/Be"),v=o.n(f),y=function(t){var e={backgroundImage:"url("+t.logo+")"},o=function(e){g.a.isFunction(t.onEdit)&&(e.stopPropagation(),t.onEdit())},r=function(e){g.a.isFunction(t.onDelete)&&(e.stopPropagation(),t.onDelete())};return n.a.createElement(c.a,{className:a()(v.a["template-card"],t.className),onClick:t.onClick},n.a.createElement("div",{className:"template-card__cover",style:e}),n.a.createElement("div",{className:"template-card__mask"}),n.a.createElement("div",{className:"template-card__header"},function(){if(t.creatorName){var e=[h.a.get("creator"),h.a.get("colon"),t.creatorName];return n.a.createElement("div",{className:"template-card__creator"},""+e.join(""))}return n.a.createElement("span",null)}(),t.handler?n.a.createElement("div",{className:"template-card__handler"},t.handler):t.editable?n.a.createElement("div",{className:"template-card__handler"},n.a.createElement(s.Icon,{name:"pencil",onClick:o}),n.a.createElement(s.Icon,{name:"trash",onClick:r})):void 0),n.a.createElement("div",{className:"base-card__content"},n.a.createElement("div",{className:"base-card__name"},n.a.createElement("div",{className:"template-card__namewrap"},t.name),n.a.createElement("div",{className:"template-card__tags"},t.pro&&n.a.createElement("div",{className:"template-card__pro"},"PRO"),t.taskflow&&n.a.createElement("div",{className:"template-card__taskflow"},h.a.get("taskflow")))),t.description&&n.a.createElement("div",{className:"base-card__desc"},t.description)),t.new&&n.a.createElement("div",{className:"template-card__new"},"NEW"))},b=o("mrSGxOB2"),w=o("1yRUKSIR"),j=function(t){return n.a.createElement(y,b.a({},t,{onClick:function(){g.a.isFunction(t.onChange)&&t.onChange(!t.activated)},className:a()(w["template-selector-card"],t.className),handler:n.a.createElement("div",{className:a()("template-selector-card__checkbox",{activated:t.activated})},n.a.createElement("input",{type:"checkbox",value:t.activated?"on":"off"}))}))},k=o("d72Xq/Gk");o.d(e,"a",function(){return u}),o.d(e,"c",function(){return y}),o.d(e,"d",function(){return j}),o.d(e,"b",function(){return k.a})},"/VuqkkbT":function(t,e){t.exports=function(t){var e,o,r="undefined"!=typeof _encodeHTML?_encodeHTML:(e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},o=/&(?!#?\w+;)|<|>|"|'|\//g,function(t){return t?t.toString().replace(o,function(t){return e[t]||t}):""}),n='<header class="creator-header"> <h4 class="creator-title"> ';return t.isEdit?n+=' <span class="creator-location-tips">'+t.sourceName+"</span> ":(n+=' <span class="creator-location-tips">'+tb_i18n.get("post.creator.tips_1")+"</span> ",t.isStatic?n+=' <span class="creator-location"></span> ':n+=' <a class="creator-location-handler" data-gta="{action: \'move content\', type: \'post\', control: \'Global New Post\'}"> <span class="creator-location"></span> <span class="icon icon-chevron-down"></span> </a> ',n+=' <span class="creator-location-tips">'+tb_i18n.get("post.creator.tips_2")+"</span> "),n+=' </h4> <a class="creator-close pull-right icon icon-remove"></a></header><header class="post-creator-header"> <input class="form-control post-title-input" type="text" placeholder="'+tb_i18n.get("post.creator.title.placeholder")+'" maxlength="70" value="'+r(t.title)+'"/></header><section class="post-creator-body ',t.isEdit&&(n+="is-edit"),n+='"> <section class="post-creator-editor-wrap"></section> ',t.hasMemCache&&(n+=' <div class="draft">'+tb_i18n.get("draft")+' <a class="restore-draft">'+tb_i18n.get("draft.restore")+'</a> <a class="discard-draft">'+tb_i18n.get("draft.discard")+"</a> </div> "),n+=' <footer class="involve-set"></footer></section><footer class="post-creator-footer"> <div class="post-creator-footer-fixed"> <a class="creator-visible"></a> <button class="btn btn-primary submit-handler pull-right"> ',t.isEdit?n+=""+tb_i18n.get("post.update"):n+=""+tb_i18n.get("submit.post"),n+=" </button> </div></footer>"}},"1yRUKSIR":function(t,e,o){t.exports={"template-selector-card":"template-selector-card__bY34"}},"39JQG7WM":function(t,e,o){t.exports={"template-sub-category":"template-sub-category__1nrc","template-sub-category-header":"template-sub-category-header__2G26","template-list-wrap":"template-list-wrap__3bD6","template-card":"template-card__32C7","template-sub-category-handler":"template-sub-category-handler__3lBJ","management-btn":"management-btn__AVMj"}},"3PZ/ulnr":function(t,e,o){"use strict";o.r(e),o.d(e,"UsedTemplatesStore",function(){return i});var r=o("mrSGxOB2"),n=o("sa1Ed382"),i=function(){function t(){var t=this;this.store=new Set,this.key="usedTemplates",(n.PREFERENCE.get(this.key)||[]).forEach(function(e){return t.store.add(e)})}return t.prototype.sync=function(){n.PREFERENCE.set(this.key,r.h(this.store))},t.prototype.add=function(t){var e=this.store.size;this.store.add(t),this.store.size>e&&this.sync()},t.prototype.has=function(t){return this.store.has(t)},t}()},"4Wms10pP":function(t,e,o){t.exports=o.p+"images/agile-bug.c24e0e6c.png"},"6XHfNrFi":function(t,e,o){t.exports=function(t){var e="";o("2qRnoGmE").FEATURES.showTemplateCategory;return e+='<form class="form-create-project form-horizontal flex-vert flex-fill"> <header class="modal-header text-center"> ',t.showBack&&(e+=' <a class="pull-left icon icon-chevron-left fsm-action" data-fsm-action="back"></a> '),e+=' <h4 class="modal-title"> '+tb_i18n.get("project.creator.modal.choose.template")+' </h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="template-wall-search-bar"> <input class="form-control input-search-template" placeholder="'+tb_i18n.get("project.creator.modal.search.placeholder")+'" > <span class="icon icon-search" /> </div> <div class="modal-body flex-space flex"> <div class="template-sidebar"></div> <ul class="template-list flex-fill thin-scroll"></ul> </div></form>'}},"6f72WHFC":function(t,e,o){t.exports=o.p+"images/agile-story.9e427b24.png"},"8cov1ZKo":function(t,e,o){t.exports=o.p+"images/create-taskflow-project@2x.06e1ac52.png"},"8nlPGZpY":function(t,e,o){t.exports=function(t){var e,r,n="undefined"!=typeof _encodeHTML?_encodeHTML:(e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},r=/&(?!#?\w+;)|<|>|"|'|\//g,function(t){return t?t.toString().replace(r,function(t){return e[t]||t}):""}),i="",a=o("2qRnoGmE");if(i+='<section class="template-task-flow flex-vert"> ',t.taskflowEnabled?i+=' <div class="overview-title"> '+tb_i18n.get("project.creator.template.taskflow")+' <a href="'+a.HELP_CENTER_URL+'/hc/kb/article/1206920/" target="_blank" data-gta="{action: \'intro taskflow\', category: \''+t.template.name+'\', control: \'template list\'}"> <span class="icon icon-info hinted" data-title="'+tb_i18n.get("project.template.overview.taskflow.tips")+'"></span> </a> </div> ':i+=' <div class="overview-title">'+tb_i18n.get("table.task.stage")+"</div> ",i+=' <ul class="overview-content flex"> ',t.taskflowEnabled&&t.taskflowstatuses&&t.taskflowstatuses.length>0){i+=" ";var s=t.taskflowstatuses;if(s)for(var c,l=-1,p=s.length-1;l<p;)c=s[l+=1],i+=" ",l>9||(i+=' <li class="template-task-flow-item taskflow"> <span class="item-name">'+n(c.name)+"</span> </li> ");i+=" "}else if(t.tasklists&&t.tasklists.stages&&t.tasklists.stages.length>0){i+=" ";var u=t.tasklists.stages;if(u){l=-1;for(var d,h=u.length-1;l<h;)d=u[l+=1],i+=" ",l>9||(i+=' <li class="template-task-flow-item"> <span class="item-name">'+n(d.name)+"</span> </li> ")}i+=" "}i+=' </ul></section><section class="template-app-plugin flex-vert"> <div class="overview-title">'+tb_i18n.get("project.creator.template.applugins")+'</div> <ul class="overview-content flex"> ';var m=t.applications;if(m)for(var g,f=-1,v=m.length-1;f<v;)i+=' <li class="template-app-plugin-item"> <span class="item-icon icon-'+(g=m[f+=1]).name+'"></span> <span class="item-name">'+t.APP_NAME[g.name]+"</span> </li> ";return i+=" </ul></section>"}},"9Epak9CN":function(t,e,o){t.exports={"loading-card":"loading-card__1LXi"}},"9Nam0gw1":function(t,e,o){var r,n,i,a,s,c,l,p,u={}.hasOwnProperty;p=o("a+N5u/Cl"),s=o("vmWJWrVe"),a=o("eubUSX4T"),c=o("5CiSxGri"),i=o("ypWNgh6R"),l=o("WRIFfSP1"),n=o("p5Ufk1Ob"),r=o("IIKHnkqe"),t.exports=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return function(t,e){for(var o in e)u.call(e,o)&&(t[o]=e[o]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,s),e.prototype.viewName="PostMdEditorView",e.prototype.className="post-md-editor",e.prototype.tagName="section",e.prototype.events={"input .editor-input":"handleTextInput","click .editor-input":"saveCaretPos","click .add-work-handler":"toggerWorksPicker","click li.work":"clickToInsertImage","click .md-help-handler":"openMdHelper"},e.prototype.initialize=function(t){return this.options=t,this._projectId=t._projectId,this.attachments=t.attachments||new a,this.renderBasic(),this.renderMD(),this.renderAttachments(),this.listen()},e.prototype.listen=function(){return this.listenTo(this.attachments,"remove add",this.renderAttachments),this.listenTo(this.attachments,"change:completed",(t=this,function(e,o){if(o)return t.insertImage(e)}));var t},e.prototype.renderBasic=function(){var t;return this.$el.html(r({content:this.options.content||""})),this.$editorBarWrap=this.$(".editor-bar-wrap"),this.$textareaset=this.$(".editor-input"),this.$mdWrap=this.$(".editor-md-wrap"),this.$attachmentsWrap=this.$(".editor-attachments"),this.$textareaset.flexText((t=this,function(){return t.options.onchange(t.get())})),this.caretPos=this.get().length},e.prototype.renderMD=function(){return this.$mdWrap.html(window._encodeHTML(this.get(),"MD"))},e.prototype.renderAttachments=function(){var t,e;return t=this.$attachmentsWrap.empty(),this.attachments.each((e=this,function(o){return e.requestSubView(c,{workModel:o,thirdtitle:!0}).$el.prependTo(t)}))},e.prototype.setProjectId=function(t){return this._projectId=t},e.prototype.toggerWorksPicker=function(t){var e;if(e=$(t.currentTarget),!this.worksPicker||this._projectId!==this.worksPicker._projectId)return this.worksPicker=this.requestSubView(l,{container:this.$el,_projectId:this._projectId,collection:this.attachments,$toggler:e,placement:"right"}).show()},e.prototype.openMdHelper=function(){var t;return null!=(t=this.markdownHelperView)&&t.remove(),this.markdownHelperView=this.requestSubView(i,"markdown-helper").open(n),this},e.prototype.clickToInsertImage=function(t){var e,o;return o=(e=$(t.currentTarget)).data("id")||e.data("cid"),this.insertImage(this.attachments.get(o)),this},e.prototype.insertImage=function(t){var e,o,r;if(r=this.getPreviewUrl(t))return o=" !["+(t.get("fileName")||r)+"]("+r+") ",e=(e=this.get().replace(/\r/,"")).slice(0,this.caretPos)+o+e.slice(this.caretPos),this.set(e),this.caretPos+=o.length,this.$textareaset[0].selectionStart=this.caretPos,this.$textareaset[0].selectionEnd=this.caretPos,this},e.prototype.saveCaretPos=function(t){return this.caretPos=this.$textareaset[0].selectionStart,this},e.prototype.handleTextInput=function(t){return this.saveCaretPos(t),this.renderMD(),this},e.prototype.getPreviewUrl=function(t){var e,o,r,n,i;if(t)return n=t.get("thumbnailUrl")||"",i=t.get("imageWidth"),e=t.get("imageHeight"),r=i<400?200:i<600?400:i<800?600:800,o=Math.ceil(r*e/i),n=n.replace("w/200/h/200","w/"+r+"/h/"+o)},e.prototype.get=function(){return this.$textareaset.val().trim()},e.prototype.set=function(t){return this.$textareaset.val(t),this},e.prototype.focus=function(){return p.delay((t=this,function(){if(t.$el)return t.$textareaset.focusAtEnd()}),100);var t},e}()},"9l7jY84A":function(t,e,o){"use strict";o.d(e,"a",function(){return l});var r=o("q1tIBJhx"),n=o.n(r),i=o("TSYQbtd+"),a=o.n(i),s=o("RuNYWSGo"),c=o.n(s),l=function(t){return n.a.createElement("div",{className:a()(c.a["base-card"],t.className),onClick:t.onClick},n.a.createElement("div",{className:"base-card__container"},n.a.createElement("div",{className:"base-card__main"},t.children)))}},An2e027E:function(t,e,o){t.exports=o.p+"images/agile-sprint.af082fdd.png"},BAfrpAo7:function(t,e,o){"use strict";o.r(e);var r=o("4BeYQFX4"),n=o.n(r),i=o("IaFtV71y"),a=o.n(i),s=new n.a({id:"gray-arrow",use:"gray-arrow-usage",viewBox:"0 0 11 12",content:'<symbol viewBox="0 0 11 12" id="gray-arrow"><path fill="none" fill-rule="evenodd" stroke="#383838" stroke-linecap="round" stroke-linejoin="round" stroke-opacity=".1" stroke-width="2" d="M4 3l3 3-3 3" /></symbol>'});a.a.add(s);e.default=s},CjouHKrC:function(t,e,o){t.exports=o.p+"images/illustration@3x.2d8d2cc3.png"},DfGQzvyE:function(t,e,o){t.exports={"create-card":"create-card__1fK_"}},IIKHnkqe:function(t,e){t.exports=function(t){return'<header> <div class="editor-bar-wrap"></div></header><section> <div class="editor-content clearfix"> <textarea class="editor-input" autofocus placeholder="'+tb_i18n.get("wall.view.post.creator.placeholder")+'">'+t.content+'</textarea> <div class="editor-md-wrap"></div> </div></section><footer> <div class="post-editor-info"> <a class="add-work-handler pull-left" data-gta="event" data-label="activity add works"> <span class="icon icon-paperclip"></span>'+tb_i18n.get("activity.timeline.add.attachment")+' </a> <span class="post-creator-mdhelper muted pull-right"> '+tb_i18n.get("post.creator.markdown.tips")+' </span> </div> <ul class="editor-attachments clearfix"></ul></footer>'}},JopwBw83:function(t,e,o){var r,n,i,a,s,c,l,p,u,d,h,m,g,f,v,y,b,w,j,k,T,_,P,C,I,E=function(t,e){return function(){return t.apply(e,arguments)}};y=o("a+N5u/Cl"),m=o("q1tIBJhx"),f=o("GESwhXbR").Toast,i=o("bZr3G77e"),I=o("sa1Ed382"),o("2qRnoGmE"),a=o("4c1CS0b3").Observable,P=o("80gYlwjC"),l=P.PlanType,P.Payment,j=o("tXB4VUxf").checkValidUniqueIdPrefixAsync,p=o("77NnVLwu"),v=o("3eMzznN/"),s=o("85182E8g"),d=o("nL4olqOP"),u=o("BLZfz376"),g=o("//SEpMEE"),r=null,c=o("8nlPGZpY"),_=o("NtzEC3Pa"),T=o("VKSb0RCs").getProOverview,b=o("9+0BJoM0").checkIsAppAvailable,h=o("Nohvfk+i"),C=o("gpXgy0o6"),w=C.checkLimitTaskflowProjects,k=C.formatTaskflowProjectByVisible,t.exports=function(){function t(t){var e,n,i,a;this._organizationId=t._organizationId,this._direct_template=t._direct_template,this.projectTagId=t.projectTagId,i=t.projectTagSnippet,this.selectedOrganizationModel=t.selectedOrganizationModel,this.selectedTemplate=t.selectedTemplate,this.taskflowProjects=t.taskflowProjects,this.normalType=t.normalType,this.view=t.view,this.gtaControl=t.gtaControl,this.getAgileTemplate=E(this.getAgileTemplate,this),n=arguments[0],this.$el=$('<div class="modal-content"></div>'),this.modalEvents={"input .project-name":y.bind(this.handleNameInput,this),"input .project-unique-id-prefix":y.bind(this.handleUniqueIdPrefixInput,this),"submit .form-create-project":this.onCreateProjectFormSubmit.bind(this),"click .show-taskflow-projects":y.bind(this.onShowTaskflowProjectsList,this),"click .taskflow-project-item":y.bind(this.onClickTaskflowProjectItem,this),"mousedown .btn-upgrade-organization":y.bind(this.onClickUpgradePro,this)},this.isLimitedTaskflowProject=this.checkTaskflowEnabled()&&w(this.taskflowProjects,this.selectedOrganizationModel),e=this.selectedTemplate&&!this.isLimitedTaskflowProject,r=o("eL7ZptkA")("./"+(e?"template":"simple")),this._organizationId||(this._organizationId=this.getOrganizationId()),this.isOrgProPreviewMounted=!1,this.readOrganizations().then((a=this,function(t){return a.organizationsCollection=t})).then(function(t){return function(){if(!t._organizationId||!1===t.hasOwnOrganizations())return t._organizationId=null}}(this)).then(function(t){return function(){return t.selectedOrganizationModel||(t.selectedOrganizationModel=t.organizationsCollection.get(t._organizationId))}}(this)).then(function(t){return function(){return n.selectedOrganizationModel||(n.selectedOrganizationModel=t.organizationsCollection.get(t._organizationId))}}(this)).then(function(t){return function(){return t.readProjectTags()}}(this)).then(function(t){return function(e){return t.projectTagsCollection=e}}(this)).then(function(t){return function(){return t.reset()}}(this)).then(function(t){return function(){return t.readProjectPreview()}}(this)).then(function(t){return function(){if("agile"===t._direct_template)return t.getAgileTemplate()}}(this)).then(function(t){return function(){return t.initializeFormSchema()}}(this)).then(function(t){return function(){return t.renderBasic()}}(this)).then(function(t){return function(){if(t.handleNameInput(),t.taskUniqueIdEnabled())return t.handleUniqueIdPrefixInput()}}(this)).then(function(t){return function(){return I.PREFERENCE.isPersonalWorkspace()?t.$projectSection.hide():(t.projectTagSelectorCache={},i&&(t.projectTagSelectorCache[i._id]=i),t.initSectionSelector())}}(this))}return t.prototype.getAgileTemplate=function(){return i.get("projecttemplates?_organizationId="+this._organizationId).then((t=this,function(e){return t.selectedTemplate=y.find(e,function(t){return"scrum"===t.subtype&&y.contains(t.categories,"proTemplate")})}));var t},t.prototype.getOrganizationId=function(){return null!=this.selectedOrganizationModel?this.selectedOrganizationModel.id:I.PREFERENCE.isPersonalWorkspace()?null:I.PREFERENCE.get("lastWorkspace")},t.prototype.getOrganizationModel=function(){return this.organizationsCollection?this.organizationsCollection.get(this._organizationId):[]},t.prototype.getOwnOrganizations=function(){var t,e,o;return t=function(){return{_id:I.user.id,title:tb_i18n.get("my.projects")}},o=this,e=function(){return o.organizationsCollection?o.organizationsCollection.map(function(t){return t.payment.isActive&&t.hasPermission("post.project")?{_id:t.id,title:t.get("name")}:null}):[]},y.chain([t()]).union(e()).compact().value()},t.prototype.getProjectTagModels=function(){return this.projectTagsCollection?this.projectTagsCollection.getOrganizationProjectTagModels(this._organizationId):[]},t.prototype.getProjectModel=function(){return this.projectModel},t.prototype.hasOwnOrganizations=function(){return y.find(this.getOwnOrganizations(),(t=this,function(e){return e._id===t._organizationId}));var t},t.prototype.readOrganizations=function(){return new Promise((t=this,function(e,o){return t.$el.get(0)?s.fetch(0,{error:function(t,e){return o(e)},success:function(t){return e(t)}}):o()}));var t},t.prototype.readProjectTags=function(){return new Promise((t=this,function(e,o){return t.$el.get(0)?t._organizationId?u.fetchByOrganizationId(t._organizationId).then(function(t){return e(t)}).catch(function(t,e){return o(e)}):e():o()}));var t},t.prototype.readProjectPreview=function(){var t;if(this.selectedTemplate&&this.selectedTemplate._id)return this.view.showLoadingIndicator(this.$el),i.get("projecttemplates/"+this.selectedTemplate._id+"/preview").then((t=this,function(e){return t.projectPreview=e,t.view.hideLoadingIndicator()}))},t.prototype.reset=function(){var t,e,o;return t=y.extend({},this._organizationId?{_organizationId:this._organizationId}:null,this.projectTagId?{projecttagIds:[this.projectTagId]}:null,this.checkTaskflowEnabled()?{normalType:"taskflow"}:null),this.projectModel=new p(t),this.view.listenTo(this.organizationsCollection,"add remove",(o=this,function(){var t;return null!=(t=o.ownerMenuView)?t.update(o.getOwnOrganizations()):void 0})),null!=(e=this.selectedOrganizationModel)?e.on("change:plan",function(t){return function(){return t.renderBasic(),t.initSectionSelector()}}(this)):void 0},t.prototype.checkTaskflowEnabled=function(){var t;return"taskflow"===(null!=(t=this.selectedTemplate)?t.normalType:void 0)||"taskflow"===this.normalType},t.prototype.renderBasic=function(){var t,e,o,n,i,a,s,c,p,u,d,h,m,f,v,b;return t=y.pluck(null!=(c=this.projectPreview)?c.applications:void 0,"name"),o=y.some(t,function(t){return g.isScrumApp(t)}),i=null!=(p=this.selectedTemplate)?p.isPro:void 0,e=(null!=(u=this.selectedOrganizationModel)?u.payment.isProfessional:void 0)&&(null!=(d=this.selectedOrganizationModel)?d.payment.isActive:void 0),b=(n=(i||o)&&!e)?this.selectedTemplate.name:tb_i18n.get("project.creator.fillTemplate"),a=(null!=(h=this.selectedOrganizationModel)?h.id:void 0)||I.user.id,v=k(this.taskflowProjects),this.$el.html(r({taskflowEnabled:this.checkTaskflowEnabled(),limitedCreateTaskflowProject:this.isLimitedTaskflowProject,taskflowProjectsVisible:v.visible,taskflowProjectsInvisible:v.invisible,isProTemplate:i,hasPaid:e,isDisabled:n,organization:this.selectedOrganizationModel,organizationName:(null!=(m=this.selectedOrganizationModel)?m.get("name"):void 0)||tb_i18n.get("my.projects"),selectedTemplate:this.selectedTemplate,title:b,showUniqueIdPrefix:this.taskUniqueIdEnabled(),uniqueIdPrefix:this.getFormFieldValue("uniqueIdPrefix"),showBackButton:"agile"!==this._direct_template,paymentId:a,payProtocol:_.paywallUrl(l.Wildcard,_.FeatureType.UpgradeToPro,a,"agile-template")})),this.isLimitedTaskflowProject&&I.gta.event({action:"workflow project limit",control:"create workflow project",method:"show"}),this.$templateOverview=this.$el.find(".template-overview"),s=T(null!=(f=this.selectedTemplate)?f.subtype:void 0),i&&s?(this.view.requestReactView(this.$templateOverview.get(0),s),this.isOrgProPreviewMounted=!0):this.selectedTemplate&&this.renderNormalPreview(),this.$projectNameInput=this.$el.find(".project-name"),this.$projectDescriptionInput=this.$el.find(".project-description"),this.$btnCreateProject=this.$el.find(".btn-create-project"),this.$projectSection=this.$el.find(".project-section"),this.$projectSectionFormGroup=this.$el.find(".project-section .form-group"),this.$projectSectionToggler=this.$el.find(".project-section .open-selector-handler"),this.$projectSectionSelectorTitle=this.$el.find(".project-section .selector-title"),this.$projectUniqueIdPrefix=this.$el.find(".project-unique-id-prefix"),this.$projectUniqueIdPrefixError=this.$el.find(".project-unique-id-prefix-error"),this.$projectUniqueIdPrefixErrorText=this.$el.find(".project-unique-id-prefix-error-text"),this.getProjectModel(),this},t.prototype.onShowTaskflowProjectsList=function(){return this.view.$(".show-taskflow-projects").hide(),this.view.$(".taskflow-project").show()},t.prototype.onClickTaskflowProjectItem=function(t){var e;return e=this.view.$(t.target).closest(".taskflow-project-item").data("id"),window.open("project/"+e)},t.prototype.onClickUpgradePro=function(){return I.gta.event({action:"update to pro",control:"create workflow project"})},t.prototype.taskUniqueIdEnabled=function(){var t,e;return(null!=(t=this.selectedTemplate)?t.isPro:void 0)||y.some(null!=(e=this.projectPreview)?e.applications:void 0,{name:"taskUniqueId"})},t.prototype.renderNormalPreview=function(){var t,e,o,r;if(this.projectPreview)return e=this.projectPreview,t=y.chain(e.applications).sortBy(function(t){return 1===t.type?t.order:Number.MAX_SAFE_INTEGER}).filter(function(t){return b(t.name)}).value(),r=e.taskflows?null!=(o=e.taskflows[0])?o.taskflowstatuses:void 0:[],e=y.extend({},e,{applications:t}),this.$templateOverview.html(c(y.extend({},n(),{taskflowEnabled:this.checkTaskflowEnabled(),tasklists:y.sample(e.tasklists),applications:e.applications,taskflowstatuses:r,template:this.selectedTemplate})))},t.prototype.onbeforego=function(){return!0},t.prototype.onbeforeback=function(){return!this.$btnCreateProject.isCreating&&(this.isOrgProPreviewMounted&&(this.view.unmountReact(this.$templateOverview.get(0)),this.isOrgProPreviewMounted=!1),!0)},t.prototype.onOpen=function(){var t;return null!=(t=this.$projectNameInput)&&t.focusAtEnd(),this},t.prototype.onCreateProjectFormSubmit=function(t){return t.preventDefault(),this.createProject()},t.prototype.createProject=function(){var t,e,o;if(!this.$btnCreateProject.isCreating)return(e={}).name=this.getFormFieldValue("name"),e.name?(this.selectedTemplate?(e._projecttemplateId=this.selectedTemplate._id,e.category=this.selectedTemplate.categories[0],this.taskUniqueIdEnabled()&&(e.uniqueIdPrefix=this.getFormFieldValue("uniqueIdPrefix"))):e.description=this.$projectDescriptionInput.val().trim(),this.projectModel.set(e),t=this.projectModel.toJSON(),d.get(this._organizationId||0).create(t,{url:this.selectedTemplate?"projects/from-template":void 0,wait:!0,beforeSend:(o=this,function(){return o.$btnCreateProject.isCreating=!0,o.$btnCreateProject.addClass("is-submitting"),o.$btnCreateProject.find("span").text(tb_i18n.get("project.creator.creating"))}),success:function(t){return function(o){var r,n,i,a,s,c;return(r=o.get("_organizationId"))&&null!=(i=t.organizationsCollection.get(r))&&i.fetch({reset:!0}),t.view.close(),I.router.navigate("project/"+o.id+"/home",{trigger:!0}),n=(null!=(a=t.selectedTemplate)?a.isDemo:void 0)?null!=(s=t.selectedTemplate)?s.name:void 0:(null!=(c=t.selectedTemplate)?c._organizationId:void 0)?"organization":"personal",t.selectedTemplate?I.gta.event({action:"added content",type:"project",category:n,note1:e.category,control:t.gtaControl,fromTemplate:e._projecttemplateId,method:"click",page:"Org Projects Page",project_template_algo:I.ab.getTestGroup("all","project_template_algo")}):I.gta.event({action:"added content",type:"project",category:o.get("normalType")?"工作流项目":"普通项目",note1:"blank project",control:"new project button"})}}(this),error:function(t){return function(e){if(t.$btnCreateProject.isCreating=!1,t.$btnCreateProject.removeClass("is-submitting"),t.$btnCreateProject.find("span").text(tb_i18n.get("done")),t.selectedTemplate)return f.error({message:tb_i18n.get("project.creator.template.failed")})}}(this)}),this):this.$projectNameInput.focusAtEnd()},t.prototype.initSectionSelector=function(){var t,e,o,r,n,i,s,c,l;if(n=this.$projectSectionFormGroup.get(0))return e=this.getOrganizationId(),t=h.createSelector({search:h.loadSearch.bind(null,e),loadRecommend:h.loadRecommend.bind(null,e),loadChildren:h.loadChildren.bind(null,e),create:h.create.bind(null,e)}),r=this.getProjectModel(),s=this.getTagSnippets(null!=r?r.get("projecttagIds"):void 0),i=h.genTagSelectorTitle(s),(null!=(o=this.getOrganizationModel())?o.getRoleScope():void 0)>=0?(c=m.createElement(h.Trigger,i),this.view.requestReactView(n,t,{trigger:c,triggerRef:i.ref,selected:s,withCreator:o.hasPermission("organization.projecttag.post"),commit:(l=this,function(t){var e,o;return o=t.payload,e=t.cache,a.of(null).do(function(){if(o)return r.set({projecttagIds:o}),l.projectTagSelectorCache=e,l.initSectionSelector()})})})):(i=y.extend({},i,{isDisabled:!0}),this.view.requestReactView(n,h.Trigger,i))},t.prototype.getTagSnippets=function(t){var e,o;return null==t&&(t=[]),e=this.getProjectTagModels(),t.map((o=this,function(t){var r,n,i;return(i=null!=(r=e.find(function(e){return e.id===t}))?r.toJSON():void 0)||(i=null!=(n=o.projectTagSelectorCache)?n[t]:void 0),i})).filter(Boolean)},t.prototype.handleOpenSelectorHandler=function(){return I.gta.event({action:"toggle project tag",control:"new project"})},t.prototype.initializeFormSchema=function(){var t;return this.formSchema={valueMap:{name:(null!=(t=this.selectedTemplate)?t.name:void 0)||"",uniqueIdPrefix:v.getUniqueId(4,"onlyAlphabet")},touchMap:{},errorMap:{}}},t.prototype.touchFormField=function(t){return this.formSchema.touchMap[t]=!0},t.prototype.setFormFieldValue=function(t,e){return this.formSchema.valueMap[t]=e},t.prototype.getFormFieldValue=function(t){return this.formSchema.valueMap[t]},t.prototype.setFormFieldError=function(t,e){var o;return this.formSchema.errorMap[t]=e,o=y.some(this.formSchema.errorMap,y.identity),this.$btnCreateProject.prop("disabled",o)},t.prototype.handleNameInput=function(t){var e,o;return null==t&&(t=null),t&&this.touchFormField("name"),o=t?t.currentTarget.value.trim():this.getFormFieldValue("name"),this.setFormFieldValue("name",o||""),e=!o,this.setFormFieldError("name",e)},t.prototype.handleUniqueIdPrefixInput=function(t){var e;return null==t&&(t=null),t&&this.touchFormField("uniqueIdPrefix"),e=t?t.currentTarget.value.trim():this.getFormFieldValue("uniqueIdPrefix"),this.setFormFieldValue("uniqueIdPrefix",e||""),this.$projectUniqueIdPrefix.removeClass("has-error"),this.$projectUniqueIdPrefixError.hide(),this.validateUniqueIdPrefix(e)},t.prototype.validateUniqueIdPrefix=y.debounce(function(t){return j(this._organizationId,t).then((e=this,function(){return e.setFormFieldError("uniqueIdPrefix",void 0)})).catch(function(t){return function(e){if(t.setFormFieldError("uniqueIdPrefix",!0),t.formSchema.touchMap.uniqueIdPrefix&&(t.$projectUniqueIdPrefix.addClass("has-error"),e))return t.$projectUniqueIdPrefixError.show(),t.$projectUniqueIdPrefixErrorText.text(e.message)}}(this));var e},200),t.prototype.remove=function(){return _.closePaywall()},t}(),n=function(){return{APP_NAME:{tasks:tb_i18n.get("tasks"),posts:tb_i18n.get("posts"),works:tb_i18n.get("works"),events:tb_i18n.get("events"),groupchat:tb_i18n.get("groupchat"),bookkeeping:tb_i18n.get("bookkeeping"),shimo:tb_i18n.get("project.creator.template.plugin.name.shimo"),markdown:tb_i18n.get("project.creator.template.plugin.name.markdown"),tasklist:tb_i18n.get("project.creator.template.plugin.name.tasklist"),startDate:tb_i18n.get("project.creator.template.plugin.name.startDate"),taskUniqueId:tb_i18n.get("powerups.taskUniqueId"),timeView:tb_i18n.get("powerups.timeView"),tableView:tb_i18n.get("powerups.tableView"),evernote:"Evernote",yinxiang:"印象笔记",weibo:tb_i18n.get("powerups.weibo"),github:"GitHub",processon:"ProcessOn",jinshuju:tb_i18n.get("powerups.jinshuju"),zoomus:"Zoom",analytics:tb_i18n.get("powerups.analytics"),gitintegration:tb_i18n.get("powerups.git.integration"),projectinfoapp:tb_i18n.get("powerups.project.info"),testplan:tb_i18n.get("powerups.testplan"),story:tb_i18n.get("agile.requirements"),bug:tb_i18n.get("agile.bugs"),sprint:tb_i18n.get("agile.sprints")}}}},KH1MmGoJ:function(t,e,o){"use strict";var r=o("q1tIBJhx"),n=o.n(r),i=o("tLZJUYWX"),a=o.n(i),s=o("GESwhXbR"),c=function(t){return n.a.createElement(s.TextButton,{className:t.className,color:"blue",onClick:t.onCreateTemplate},n.a.createElement(s.Icon,{name:"circle-plus"}),a.a.get("project.creator.create.template"))};o.d(e,"a",function(){return c})},LISneMer:function(t,e,o){"use strict";o.r(e);var r,n=o("mrSGxOB2"),i=o("a+N5u/Cl"),a=o.n(i),s=function(){function t(){this.history=[],this.hooksMap=new Map}return Object.defineProperty(t.prototype,"anchor",{get:function(){return a.a.last(this.history)},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e){var o=this.hooksMap.get(t)||[];this.hooksMap.set(t,n.h(o,[e]))},t.prototype.push=function(t){this.tap("blockPush",t,this.history)||(this.history.push(t),this.tap("changed",n.h(this.history)))},t.prototype.back=function(){this.history.pop(),this.tap("changed",n.h(this.history))},t.prototype.tap=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var r=this.hooksMap.get(t);return!!r&&r.some(function(t){return Boolean(t.apply(void 0,n.h(e)))})},t}();!function(t){t.TemplateRecommendation="template-recommendation",t.FromTemplate="from-template",t.SimpleCreator="simple-creator",t.TaskflowCreator="taskflow-creator",t.TemplateWall="template-wall"}(r||(r={})),o.d(e,"PageHistory",function(){return s}),o.d(e,"Page",function(){return r})},NCcsFKvO:function(t,e,o){t.exports=o.p+"images/agile-version.c4a2f10b.png"},"O+4JvPq5":function(t,e,o){"use strict";o.r(e);var r=o("4BeYQFX4"),n=o.n(r),i=o("IaFtV71y"),a=o.n(i),s=new n.a({id:"blue-arrow",use:"blue-arrow-usage",viewBox:"0 0 11 12",content:'<symbol viewBox="0 0 11 12" id="blue-arrow"><path fill="none" fill-rule="evenodd" stroke="#3DA8F5" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 3l3 3-3 3" /></symbol>'});a.a.add(s);e.default=s},PStsLZKE:function(t,e,o){"use strict";o.r(e);var r=o("mrSGxOB2"),n=o("q1tIBJhx"),i=o.n(n),a=o("sa1Ed382"),s=o("TSYQbtd+"),c=o.n(s),l=o("2qRnoGmE"),p=o.n(l),u=o("GESwhXbR"),d=o("tLZJUYWX"),h=o.n(d),m=o("i8i4LrFt"),g=o.n(m),f=o("/MKjzBat"),v=o("ctsD9mWH"),y=function(){function t(){}return t.open=function(e){t.mountNode||o.e(30).then(function(r){var n=o("dT8yDsKJ").ProjectTemplateManagementContainer,a=o("fLIokW7y"),s=a.epic,c=a.reducer;t.mountNode=document.createElement("div"),document.body.appendChild(t.mountNode),Object(v.addUIReducer)({projectTemplateManagement:c}),Object(v.addEpic)(s),g.a.render(i.a.createElement(f.Provider,{store:v.store},i.a.createElement(n,{canCreateTemplate:e.canCreateTemplate,close:t.close,createTemplate:e.createTemplate,organizationId:e.organizationId,onEditTemplate:e.onEditTemplate})),t.mountNode)}.bind(null,o)).catch(o.oe)},t.close=function(){t.mountNode&&(g.a.unmountComponentAtNode(t.mountNode),t.mountNode.remove(),t.mountNode=null)},t.mountNode=null,t}(),b=o("/6uHU+qu"),w=o("KH1MmGoJ"),j=o("39JQG7WM"),k=o.n(j),T=function(t){var e="template-sub-category";return i.a.createElement("div",{className:k.a[e]},i.a.createElement("header",{className:c()(k.a[e+"-header"],"template-sub-category-header")},i.a.createElement("h3",null,t.title),i.a.createElement("div",{className:k.a[e+"-handler"]},t.handler)),i.a.createElement("div",{className:k.a["template-list-wrap"]},t.children))},_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.handleOpenProjectTemplateManagement=function(){a.gta.event({action:"manage template",method:"click"}),y.open({createTemplate:e.props.onCreateTemplate,canCreateTemplate:e.props.canCreateTemplate,organizationId:e.props.organizationId,onEditTemplate:e.props.onEditTemplate})},e}return r.d(e,t),e.prototype.componentDidMount=function(){a.gta.event({action:"show all template",method:"trace",project_template_algo:a.ab.getTestGroup("all","project_template_algo")})},e.prototype.renderTemplate=function(t,e){var o=this;if("blank"===e){var r=void 0;return r="template-creator-simple"===t._id?this.props.onCreateSimpleProject:this.props.onCreateTaskflowProject,i.a.createElement(b.a,{key:t._id,name:t.name,description:t.description,className:k.a["template-card"],onClick:r})}return i.a.createElement(b.c,{key:t._id,className:k.a["template-card"],creatorName:t.creator?t.creator.name:void 0,description:t.description,editable:!t.isDemo&&this.props.canHandleTemplate(t),logo:t.logo,name:t.name,new:Boolean(t.isNew),onClick:function(){return o.props.onCreateFromTemplate(t,"template list")},onDelete:function(){return o.props.onRemoveTemplate(t)},onEdit:function(){return o.props.onEditTemplate(t)},pro:!!t.isPro,taskflow:Boolean("taskflow"===t.normalType)})},e.prototype.renderCreateTemplateBtn=function(){if(p.a.FEATURES.showTemplateCategory&&this.props.canCreateTemplate)return i.a.createElement(w.a,{onCreateTemplate:this.props.onCreateTemplate})},e.prototype.renderTemplateManagementBtn=function(){if(p.a.FEATURES.showTemplateCategory&&this.props.canManageTemplate)return i.a.createElement(u.TextButton,{color:"blue",onClick:this.handleOpenProjectTemplateManagement},i.a.createElement(u.Icon,{name:"cog"}),h.a.get("project.template.management"))},e.prototype.renderCategory=function(t){var e,o=this,r=this.props.templateMap[t.category]||[];return"organization"===t.category&&(e=i.a.createElement(i.a.Fragment,null,this.renderCreateTemplateBtn(),this.renderTemplateManagementBtn())),i.a.createElement(T,{key:t.name,title:t.name,handler:e},r.map(function(e){return o.renderTemplate(e,t.category)}))},e.prototype.render=function(){var t=this;return this.props.categoryInfos.map(function(e){return t.renderCategory(e)})},e}(i.a.PureComponent);o.d(e,"ProjectTemplates",function(){return _})},Qgz2P33e:function(t,e,o){t.exports=o.p+"images/agile-analytics.eeefaeb0.png"},"R0v/qAWW":function(t,e,o){"use strict";o.r(e),o.d(e,"getRecommendTemplates",function(){return m}),o.d(e,"searchTemplate",function(){return y});var r=o("mrSGxOB2"),n=o("a+N5u/Cl"),i=o.n(n),a=o("s0r7VfKc"),s=o("sa1Ed382"),c=o("4c1CS0b3"),l=o("suI5NDUm"),p=o("2qRnoGmE"),u=o.n(p),d=o("ymFCWmUp").calcStrWeightCurry;function h(){return s.PREFERENCE.get("lastWorkspace")||"default"}function m(){var t="organizations/"+h()+"/recommend-projecttemplates";return a.default.fetch.get(t)}var g=null;function f(){var t={_organizationId:h()};return a.default.fetch.get("projecttemplates",t)}function v(){var t=c.Observable.combineLatest(f(),a.default.fetch.get("project-templates",{_organizationId:h()},{apiHost:u.a.AONE_ADAPTER_HOST})).map(function(t){var e=r.f(t,2),o=e[0],n=e[1];return o.concat(n)}),e=f();return(Object(l.isAone)()?t:e).do(function(t){return g=t})}function y(t){return(g?c.Observable.of(g):v()).map(function(e){return t?function(t,e){var o=d(1e3,e),r=d(800,e),n=function(t){return Math.max(o(t.name),r(t.description))};return i.a.chain(t).filter(function(t){return Boolean(n(t))}).sortBy(n).reverse().value()}(e,t):[]})}y.clearCache=function(){g=null}},RFllHK7R:function(t,e,o){var r,n,i,a,s,c,l,p,u,d,h,m,g,f,v,y,b,w,j,k,T,_=function(t,e){return function(){return t.apply(e,arguments)}},P={}.hasOwnProperty;j=o("a+N5u/Cl"),k=o("sa1Ed382"),m=o("GESwhXbR").Toast,n=o("/e+Ob7oW"),h=o("HYobN8SQ"),v=o("3eMzznN/"),y=o("vmWJWrVe"),g=o("RLD3BeS/").ToastMessageWithUrl,p=o("Rb7YhHxV"),a=o("odY26VIi"),d=o("nL4olqOP"),f=o("eubUSX4T"),u=o("2NlL4uak"),i=o("vNWLjLJF"),c=o("aePTiwey"),l=o("9Nam0gw1"),w=o("o4N9kv/m"),s=o("qKYkuTVR"),b=o("+h7VEZku").VisibilityController,r=o("/VuqkkbT"),T=o("gh8QIhMV").throwError,t.exports=function(t){function e(){return this.enableSubmit=_(this.enableSubmit,this),e.__super__.constructor.apply(this,arguments)}return function(t,e){for(var o in e)P.call(e,o)&&(t[o]=e[o]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,y),e.prototype.className="post-creator modal-dialog creator-view",e.prototype.events={"click .creator-location-handler":"showLocationSelector","click .submit-handler":"submit","input .post-title-input":"titleInputChangeHandler","change .post-title-input":"cachePost","keydown .post-creator-editor-wrap":"quickSubmit","click .creator-close":"close","click .restore-draft":"restoreDraft","click .discard-draft":"discardDraft"},e.prototype.saveAttrs=["_projectId","_creatorId","involveMembers","involveTeams","involveGroups","involveAllProjectMembers","content","postMode","title","visible","attachments"],e.prototype.initialize=function(t){var e,o,r,n,i,a;return this.options=t,this.isStatic=t.isStatic,this.isWorkspace=t.isWorkspace,this.isEdit=!!t.postModel,(e=null!=(r=t.parentView)?r.$el:void 0)&&e.hasClass("modal")&&e.css("display","block"),this.projectsCollection=d.get(0),this.options._projectId?this.projectModel=this.projectsCollection.get(t._projectId):this.projectModel=k.APP.getClosestProject(),(null!=(n=this.projectModel)?n.isAppEnabled("posts"):void 0)||(this.projectModel=d.get(0).find(function(t){return t.isAppEnabled("posts")})),this.projectModel?(this.isEdit?this.postMode=null!=(i=t.postModel)?i.get("postMode"):void 0:this.postMode=t.postMode,"md"!==this.postMode&&(this.postMode="html"),"md"===this.postMode?this.postType="markdown":this.postType="normal",this.localCache=h.namespace("temp").namespace("posts_wall"),this.isEdit||(this.localCacheId="post_creator_"+this.projectModel.id),o=this.localCache(this.localCacheId),!this.isEdit&&o&&o._id&&this.clearCache(),this.load({success:(a=this,function(){return a.reset(),a.renderBasic(),a.initUploader(),a.renderLoaction(),a.renderEditor(),a.renderInvolve(),a.renderVisible(),a.listen(),a.bindRefreshAndCloseAlert(),j.delay(function(){if(a.$el)return a.$footerFixed.addClass("on-fixed")},300)})}),this):this.close()},e.prototype.load=function(t){return null==t&&(t={}),a.find(this.projectModel.id)?"function"==typeof t.success?t.success():void 0:a.fetch(this.projectModel.id,{success:function(){return"function"==typeof t.success?t.success():void 0},error:function(t,e){return T(e),this.close()}})},e.prototype.reset=function(){var t,e;return this.membersCollection=a.get(this.projectModel.id),this._defaultCollectionId=this.projectModel.get("_defaultCollectionId"),this.isEdit?this.postModel=this.options.postModel.clone():((t=j.extend({_creatorId:k.user.id,involveMembers:[k.user.id],content:"",title:"",visible:"members",attachments:[]},this.localCache(this.localCacheId),{_projectId:this.projectModel.id})).involveMembers=j.filter(t.involveMembers,(e=this,function(t){return!!e.membersCollection.get(t)})),t.postMode!==this.postMode&&(t.content="",t.postMode=this.postMode),this.postModel=new p(t)),this.attachments=new f(this.postModel.get("attachments"),{_boundToObjectId:this._defaultCollectionId}),this.listen()},e.prototype.listen=function(){return this.listenTo(this.attachments,"change:downloadUrl remove",this.cachePost),this.listenTo(this.postModel,"change",this.cachePost),this.listenTo(this.postModel,"change:visible",this.renderVisible),this},e.prototype.renderBasic=function(){return"md"===this.postMode&&this.$el.addClass("markdown-mode"),this.$el.addClass(tb_i18n.getLanguage()),this.$el.html(r({hasMemCache:this.postModel.getMemCache(),isEdit:this.isEdit,isStatic:this.isStatic,postMode:this.postMode,title:this.postModel.get("title")||"",sourceName:this.getSourceName()})),this.$location=this.$(".creator-location"),this.$submit=this.$(".submit-handler"),this.$titleInput=this.$(".post-title-input"),this.$visibleTitle=this.$(".visible-title"),this.$involveWrap=this.$(".involve-set"),this.$editorWrap=this.$(".post-creator-editor-wrap"),this.$visibleSwitchers=this.$(".creator-visible"),this.$footerFixed=this.$(".post-creator-footer-fixed"),this.checkSubmitState(),this},e.prototype.initUploader=function(){return this.requestSubView(w,{targetModel:this.projectModel,collection:this.attachments,dnd:this.$editorWrap,paste:this.$editorWrap})},e.prototype.renderLoaction=function(){var t;return t=this.projectModel.toJSON(),this.$location.text(t.name),this},e.prototype.renderHtmlOrMdEdit=function(){var t,e,o;return e="html"===this.postMode?"html":"content",t="md"===this.postMode?l:c,this.postEditorView=this.requestSubView(t,{_projectId:this.projectModel.id,content:this.postModel.get(e),attachments:this.attachments,onchange:(o=this,function(t){return o.postModel.set("content",t),o.checkSubmitState()})})},e.prototype.renderEditor=function(){var t;return null!=(t=this.postEditorView)&&t.remove(),this.postEditorView=this.renderHtmlOrMdEdit(),this.$editorWrap.html(this.postEditorView.$el),this},e.prototype.renderInvolve=function(){return this.requestSubView(i,{_projectId:this.projectModel.id,objectModel:this.isEdit?this.options.postModel:this.postModel,resident:[k.user.id],where:this.isEdit?"editor":"creator",enableInvite:this.projectModel.hasPermission("post.member")}).$el.prependTo(this.$involveWrap.empty()),this},e.prototype.renderVisible=function(){return this.requestReactView(this.$visibleSwitchers.get(0),b,{visibility:this.postModel.get("visible"),onChange:this.switchVisible.bind(this)})},e.prototype.switchVisible=function(t){return this.postModel.set({visible:t}),k.gta.event({action:"toggle visibility",type:"post",vontrol:"New Post"})},e.prototype.getProjectList=function(){return this.projectsCollection.getGroupListByStared({isWorkspace:this.isWorkspace,checkAppEnabled:"posts"})},e.prototype.getSourceName=function(){var t;return t=this.postModel.get("source"),function(){switch(t){case"teambition":return"md"===this.postMode?tb_i18n.get("wall.view.markdown.post"):tb_i18n.get("wall.view.html.post");case"shimo":return tb_i18n.get("powerups.shimo");default:return""}}.call(this)},e.prototype.showLocationSelector=function(t){var e,o,r;return(e=$(t.currentTarget)).data("bs.popover")||this.requestSubView(s,{container:this.$el,$toggler:e,searchPlaceholder:tb_i18n.get("task.menu.search.project"),dataList:this.getProjectList(),selected:(null!=(o=this.projectModel)?o.id:void 0)||"",select:(r=this,function(t){var e,o;if(t!==(null!=(e=r.projectModel)?e.id:void 0))return null!=(o=r.postEditorView)&&o.setProjectId(t),r.projectModel=r.projectsCollection.get(t),a.fetch(r.projectModel.get("_id"),{success:function(t){if(r.$el)return r.reset(),r.cachePost(),r.renderLoaction(),r.renderInvolve()}})})}).show(),this},e.prototype.restoreDraft=function(){var t;return(t=this.postModel.getMemCache()||{}).title&&this.$titleInput.val(t.title).focusAtEnd(),t.content&&this.postEditorView.set(t.content).focus(),this.postModel.clearMemCache(),this.$(".draft").remove(),this},e.prototype.discardDraft=function(){return this.postModel.clearMemCache(),this.$(".draft").remove(),this},e.prototype.quickSubmit=function(t){return 13===t.keyCode&&(t.ctrlKey||t.shiftKey||t.metaKey)&&(t.preventDefault(),this.submit()),this},e.prototype.submit=function(){var t;if(!this.submitLock){if(!(t=this.attachments.getUploadingCount()))return this.disableSubmit(),this.postModel.get("content")?(this.isEdit?this.updatePost():(k.gta.event({action:"added content",type:"post",control:this.options.gta_from||"Add Post",method:this.postType}),this.createPost()),this):this.postEditorView.focus();m.warning({message:tb_i18n.get("works.uploader.uploading.total",t)})}},e.prototype.createPost=function(){var t,e;return t=this.getPostAttrs(),this.createAttachments().then((e=this,function(o){return t.attachments=o,e.postModel.save(null,{attrs:t,wait:!0,error:function(){return e.enableSubmit(),e.postEditorView.focus()},success:function(t){var o,r;return e.enableSubmit(),e.clearCache(),e.stopListening(),null!=(r=u.find(t.get("_projectId")))&&r.add(t.toJSON()),!1!==e.options.isEssage&&g.success({messageTitle:tb_i18n.get("create.post.success"),url:"/project/"+t.get("_projectId")+"/posts/post/"+t.id,urlTitle:t.get("description")}),"function"==typeof(o=e.options).onsave&&o.onsave(t),e.close()}})})),this},e.prototype.updatePost=function(){var t,e;return t=j.omit(this.getPostAttrs(),"involveMembers"),this.createAttachments().then((e=this,function(o){var r;return e.options.postModel.set(t),(r=e.options.postModel.changed).attachments=o,r.visible&&e.updatePostVisible(r.visible),e.options.postModel.save(null,{wait:!0,attrs:r,success:function(t){var o;return e.enableSubmit(),e.postModel.clearMemCache(),"function"==typeof(o=e.options).onsave&&o.onsave(t),e.close()}})})),this},e.prototype.updatePostVisible=function(t){return this.options.postModel.saveAttr("visible",t)},e.prototype.createAttachments=function(t){return new Promise((e=this,function(t,o){return e.attachments.length?e.attachments.addWorks(e.attachments.toJSON(),{_parentId:e._defaultCollectionId,_projectId:e.projectModel.id,success:t,error:function(t,e){return o(e)}}):t()})).then(function(t){return function(e){return j.chain(t.attachments.toJSON()).pluck("_id").compact().union(j.pluck(e,"_id")).value()}}(this)).catch(function(t){return T(t)});var e},e.prototype.titleInputChangeHandler=function(){return this.checkSubmitState(),this},e.prototype.checkSubmitState=function(){var t,e;return e=this.$titleInput.val().trim(),t=this.postModel.get("content"),e.length&&t.length?this.enableSubmit():this.disableSubmit(),this},e.prototype.disableSubmit=function(){return this.submitLock=!0,this.$submit.prop("disabled",!0),this},e.prototype.enableSubmit=function(){return this.submitLock=!1,this.$submit.prop("disabled",!1),this},e.prototype.getPostAttrs=function(){var t;return t=j.extend(this.postModel.toJSON(),{title:this.$titleInput.val().trim()||this.getTitleFromContent(),content:this.postEditorView.get()}),j.pick(t,this.saveAttrs)},e.prototype.getTitleFromContent=function(){var t;return t=this.postModel.get("content"),t="html"===this.postMode?j.unescape(t):n(t),t=$("<div>"+t+"</div>").text().trim(),v.cutString(t,120,"...")||tb_i18n.get("post.un.title")},e.prototype.cachePost=function(){var t,e,o,r;return this.localCacheId?(e=j.extend(this.postModel.toJSON(),{title:this.$titleInput.val().trim(),attachments:this.attachments.toJSON().map(function(t){return j.omit(t,"thumbnail")})}),this.localCache(this.localCacheId,e)):(t=null!=(o=this.postEditorView)?o.get():void 0,r=this.$titleInput.val(),t===this.options.postModel.get("content")&&r===this.options.postModel.get("title")||this.postModel.setMemCache({content:t,title:this.$titleInput.val()})),this},e.prototype.clearCache=function(){return this.localCacheId&&this.localCache.remove(this.localCacheId),this},e.prototype.windowBeforeunload=function(t){return t||(t=window.event),t.returnValue=tb_i18n.get("leave.page.alert"),t.returnValue},e.prototype.bindRefreshAndCloseAlert=function(){return window.addEventListener("beforeunload",this.windowBeforeunload,!1)},e.prototype.unbindRefreshAndCloseAlert=function(){return window.removeEventListener("beforeunload",this.windowBeforeunload,!1)},e.prototype.onOpen=function(){return this.$titleInput.focusAtEnd(),this},e.prototype.onscroll=function(){var t;return null!=(t=this.postEditorView)&&"function"==typeof t.checkFixed?t.checkFixed():void 0},e.prototype.close=function(){var t,e;return this.$(".on-fixed").hide(),null!=(null!=(t=this.parentView)?t.close:void 0)?this.parentView.close():null!=(e=this.parentView)&&e.remove(),this},e.prototype.remove=function(){var t;return"function"==typeof(t=this.options).oncancel&&t.oncancel(),this.unbindRefreshAndCloseAlert(),e.__super__.remove.apply(this,arguments)},e}()},RuNYWSGo:function(t,e,o){t.exports={"base-card":"base-card__5AOB"}},VKSb0RCs:function(t,e,o){"use strict";o.r(e);var r=o("mrSGxOB2"),n=o("q1tIBJhx"),i=o("tLZJUYWX"),a=o("TSYQbtd+"),s=o.n(a),c=o("0G1xGIdh");o("g8vSXgFG");var l=o("6f72WHFC"),p=o("An2e027E"),u=o("ki3qbJ4Q"),d=o("4Wms10pP"),h=o("NCcsFKvO"),m=o("Qgz2P33e"),g=o("O+4JvPq5").default,f=o("BAfrpAo7").default,v="project-template-overviews-agile-template",y=function(t){return v+"-"+t},b=function(t){function e(e){var o=t.call(this,e)||this;return o.subscription=null,o.onSwitchNav=function(t){return function(){o.setState({activeIndex:t}),o.cancelPreviewSlideshow()}},o.grayArrowIcon=n.createElement("svg",{className:"arrow-icon","aria-hidden":"true"},n.createElement("use",{xlinkHref:"#"+f.id})),o.blueArrowIcon=n.createElement("svg",{className:"arrow-icon","aria-hidden":"true"},n.createElement("use",{xlinkHref:"#"+g.id})),o.state={activeIndex:0},o}return r.d(e,t),Object.defineProperty(e.prototype,"previewConfig",{get:function(){return[{key:"story",name:i.get("agile.preview.requirements"),desc:i.get("agile.preview.desc.requirements"),preview:l},{key:"sprint",name:i.get("agile.preview.sprints"),desc:i.get("agile.preview.desc.sprints"),preview:p},{key:"test",name:i.get("agile.preview.test"),desc:i.get("agile.preview.desc.test"),preview:u},{key:"bug",name:i.get("agile.preview.bugs"),desc:i.get("agile.preview.desc.bugs"),preview:d},{key:"version",name:i.get("agile.preview.version"),desc:i.get("agile.preview.desc.version"),preview:h},{key:"analytics",name:i.get("agile.preview.analytics"),desc:i.get("agile.preview.desc.analytics"),preview:m}]},enumerable:!0,configurable:!0}),e.prototype.componentDidMount=function(){this.setPreviewSlideshow()},e.prototype.componentWillUnmount=function(){this.cancelPreviewSlideshow()},e.prototype.setPreviewSlideshow=function(){var t=this,e=this.previewConfig.length;this.subscription=Object(c.interval)(3e3).do(function(){var o=(t.state.activeIndex+1)%e;t.setState({activeIndex:o})}).subscribe()},e.prototype.cancelPreviewSlideshow=function(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=null)},e.prototype.renderNavs=function(){var t=this,e=this.previewConfig.length-1,o=this.previewConfig.map(function(o,r){var i=o.name,a=r===t.state.activeIndex,c=s()(y("nav-item"),{active:a}),l=a?t.blueArrowIcon:t.grayArrowIcon;return n.createElement("div",{className:y("nav-item-wrap"),key:r},n.createElement("span",{className:c,onClick:t.onSwitchNav(r)},i),r<e&&l)});return n.createElement("nav",{className:y("nav")+" flex flex-center flex-vcenter"},o)},e.prototype.renderPreview=function(){var t=this.previewConfig[this.state.activeIndex];return n.createElement("div",{className:y("preview")},n.createElement("img",{src:t.preview,alt:t.name}),n.createElement("div",{className:"preview-desc"},t.desc))},e.prototype.render=function(){return n.createElement("div",{className:v},this.renderNavs(),this.renderPreview())},e}(n.PureComponent);o.d(e,"getProOverview",function(){return w});var w=function(t){switch(t){case"scrum":return b;default:return null}}},"XPhJD/Be":function(t,e,o){t.exports={"template-card":"template-card__2f3w"}},XXqLhmuA:function(t,e,o){t.exports=function(t){var e="",r=o("2qRnoGmE"),n=o("CjouHKrC"),i=o("8cov1ZKo");if(e+='<form class="form-create-project form-horizontal"> <header class="modal-header text-center"> <span class="icon icon-chevron-left fsm-action back" data-fsm-action="back"></span> <h4 class="modal-title">'+tb_i18n.get("project.creator.create.project")+'</h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body text-center"> <section class="project-creator-content"> ',t.taskflowEnabled?(e+=' <div class="illustration" style="background-image: url(\''+i+"')\"></div> ",t.selectedTemplate?e+=' <p class="intro">'+tb_i18n.get("project.creator.template.intro",_.escape(t.selectedTemplate.name))+"</p> ":e+=" <p class=\"intro\" data-gta=\"{action: 'intro taskflow', control: 'create taskflow project'}\"> "+tb_i18n.get("project.creator.taskflow.intro1")+" <a class='link-add-handler hinted' href=\""+r.HELP_CENTER_URL+"/hc/kb/article/1206920\" target='_blank' data-title=\""+tb_i18n.get("project.creator.taskflow.intro2")+'" > '+tb_i18n.get("project.creator.taskflow.intro3")+" </a> </p> ",e+=" "):e+=' <div class="illustration" style="background-image: url(\''+n+'\')"></div> <p class="intro">'+tb_i18n.get("project.creator.intro")+"</p> ",e+=" ",t.limitedCreateTaskflowProject){if(e+=' <div class="taskflow-limit-wrapper"> ',t.organization?e+=' <p class="taskflow-limit-title"> '+tb_i18n.get("project.create.taskflow.limit.intro.organization",t.taskflowProjectsVisible.length+t.taskflowProjectsInvisible.length)+" </p> ":e+=' <p class="taskflow-limit-title"> '+tb_i18n.get("project.create.taskflow.limit.intro",t.taskflowProjectsVisible.length+t.taskflowProjectsInvisible.length)+" </p> ",e+=' <span class="show-taskflow-projects">'+tb_i18n.get("project.create.taskflow.list.show")+'</span> <ul class="taskflow-project"> ',t.taskflowProjectsVisible.length){e+=" ";var a=t.taskflowProjectsVisible;if(a)for(var s,c=-1,l=a.length-1;c<l;)e+=' <li class="taskflow-project-item" data-id="'+(s=a[c+=1])._id+'"> <span>'+tb_i18n.get("project.create.taskflow.item",s.name,s.creator.name)+"</span> </li> ";e+=" "}e+=" ",t.taskflowProjectsInvisible.length&&(e+=' <span class="taskflow-project-visible-tips">'+tb_i18n.get("project.create.taskflow.invisible.tips",t.taskflowProjectsInvisible.length)+"</span> "),e+=' </ul> <p class="taskflow-limit-desc"> '+tb_i18n.get("project.create.taskflow.upgrade.tips")+' <a class="link-add-handler" href="'+r.SITE_HOST+"/tour#section-enterprise-pro\" target='_blank'>"+tb_i18n.get("learn.more")+"</a> </p> </div> "}else e+=' <div class="form-group"> <input class="project-name form-control" placeholder="'+tb_i18n.get("project.creator.porject.name.placeholder")+'"> </div> <div class="form-group"> <textarea class="project-description form-control" placeholder="'+tb_i18n.get("project.creator.porject.description.placeholder")+'"></textarea> </div> <div class="project-section"> <h5>'+tb_i18n.get("project.categories")+" ("+tb_i18n.get("is.multiple.choice.able")+')</h5> <div class="form-group"> </div> </div> ';return e+=' </section> </div> <div class="project-creator-footer modal-footer"> ',t.limitedCreateTaskflowProject?e+=' <button type=\'submit\' class="btn btn-primary btn-upgrade-organization btn-block" data-pay="'+t.payProtocol+'"> <span>'+tb_i18n.get("project.creator.upgrade.organization.pro")+"</span> </button> ":e+=" <button type='submit' class=\"btn btn-primary btn-create-project btn-block\"> <span>"+tb_i18n.get("project.creator.doneAndCreate")+"</span> </button> ",e+=" </div></form>"}},"Xb3dMF+3":function(t,e,o){var r,n,i,a,s,c,l,p,u,d,h,m,g,f,v,y,b,w,j=function(t,e){return function(){return t.apply(e,arguments)}},k=[].indexOf||function(t){for(var e=0,o=this.length;e<o;e++)if(e in this&&this[e]===t)return e;return-1};d=o("a+N5u/Cl"),h=o("2qRnoGmE"),n=o("bZr3G77e"),w=o("sa1Ed382"),u=o("ln9RsXX9").Version,f=o("suI5NDUm").isAone,l=o("wVXDg9Ql").SDKInterceptor,b=o("s0r7VfKc").default,s=o("nJ3YrKjr").ProjectTemplateEventEmitter$,i=o("M6knRl17").Observable,o("9sOPw9dz"),r=o("6XHfNrFi"),p=o("SCi816Ey"),y=o("e8ft/Wkh"),m=y.genStandardTemplateCategoryInfos,v=y.isNewTemplate,g=o("guka/Ad6").getBlankTemplate,a=o("uZT221n9").ProjectCategoriesSidebar,c=o("PStsLZKE").ProjectTemplates,t.exports=function(){function t(t){var e,o;this.options=null!=t?t:{},this.onChangeCategoryWithScroll=j(this.onChangeCategoryWithScroll,this),this.onChangeCategory=j(this.onChangeCategory,this),this._templateListScrollHandler=j(this._templateListScrollHandler,this),this.$el=$('<div class="modal-content"></div>'),this.modalEvents={"input .input-search-template":d.debounce(this.handleSearchChange.bind(this),1e3),"focus .input-search-template":this.handleInputFocus},this.selectedOrganizationModel=this.options.selectedOrganizationModel,this.taskflowProjects=this.options.taskflowProjects,this._organizationId=null!=(e=this.selectedOrganizationModel)?e.id:void 0,this.usedTemplates=this.options.usedTemplates,d.chain(this.genTemplatesCategories()).filter(function(t){return!t.deprecated}).pluck("category").value(),this.renderBasic(),this.load().then((o=this,function(){return o.projectTemplateSubscription=s.switchMap(function(t){return i.fromPromise(o.load())}).subscribe()}))}return t.prototype.load=function(){return this.options.view.showLoadingIndicator(this.$el.find(".template-list")),this.loadData().then((t=this,function(e){return t.templates=e,t.options.view.hideLoadingIndicator(),t.isLoadEnd=!0,t.parseTemplates(),t.renderTemplates()}));var t},t.prototype.fetchAoneTemplate=function(){return f()?b.fetch.get("project-templates",{_organizationId:this._organizationId},{apiHost:h.AONE_ADAPTER_HOST}).toPromise().catch(function(t){return l.ignore(t)}):Promise.resolve([])},t.prototype.loadData=function(){return Promise.all([this.fetchAoneTemplate(),n.get("projecttemplates",{data:{_organizationId:this._organizationId}}),new Promise(function(t){return d.delay(t,600)})]).then(function(t){var e,o;return e=null!=(o=t[0])?o:[],t[1].concat(e)}).then((t=this,function(e){return Date.now(),d.each(e,function(e){return e.isNew=v(e,t.usedTemplates)}),e}));var t},t.prototype.renderBasic=function(){return this.$el.html(r({categories:this.genTemplatesCategories(),showBack:this.options.history.length>1})),this.$templateSidebar=this.$el.find(".template-sidebar"),this.$templateSidebarMounted=this.$templateSidebar.get(0),this.$templateList=this.$el.find(".template-list"),this.$templateListMounted=this.$templateList.get(0),this.itemScrollTopList=null,this.standardTmplCategoryInfos=[],this.listenToTemplateList()},t.prototype.listenToTemplateList=function(){return this._listOffsetTop=this.$templateList.offset().top,this.$templateList.on("scroll",this._templateListScrollHandler)},t.prototype.cancelListenToTemplateList=function(){return this.$templateList.off("scroll",this._templateListScrollHandler)},t.prototype.getItemScrollTopList=function(){var t,e;return e=this.$templateList.find(".template-sub-category-header").toArray().map(function(t){return $(t).position().top}),16,t=e[0],e.map(function(e){return e-t+16}).slice(1)},t.prototype._templateListScrollHandler=function(){var t,e,o,r,n;if(!this.scrollingByClickCategory){for(null==this.itemScrollTopList&&(this.itemScrollTopList=this.getItemScrollTopList()),o=this.$templateList.scrollTop(),t=e=0,r=this.itemScrollTopList.length;(0<=r?e<r:e>r)&&!(o+25<this.itemScrollTopList[t]);t=0<=r?++e:--e);return this.onChangeCategory(null!=(n=this.standardTmplCategoryInfos[t])?n.category:void 0)}},t.prototype.renderTemplateSidebar=function(){var t;return null==this.currentProjectCategory&&(this.currentProjectCategory=(null!=(t=this.standardTmplCategoryInfos[0])?t.category:void 0)||""),this.options.view.requestReactView(this.$templateSidebarMounted,a,{projectCategoryInfos:this.categoryInfos,currentCategory:this.currentProjectCategory,onChangeCategory:this.onChangeCategoryWithScroll,templateMap:this.templateMap})},t.prototype.onChangeCategory=function(t){if(null==t&&(t=""),this.currentProjectCategory!==t)return this.currentProjectCategory=t,this.renderTemplateSidebar()},t.prototype.onChangeCategoryWithScroll=function(t){var e,o,r;return this.onChangeCategory(t),e=d.findIndex(this.standardTmplCategoryInfos,function(e){return e.category===t}),o=this.$templateList.find(".template-sub-category-header").eq(e),this.scrollingByClickCategory=!0,p(o.get(0),"scroll",{container:this.$templateList.get(0),duration:300,offset:0}).then((r=this,function(){return r.scrollingByClickCategory=!1}))},t.prototype.renderTemplates=function(){var t,e;return e=this.templates,e=g("standard").concat(e),t=this.getIsOrgPro(),this.categoryInfos=this.getStandardTmplCategoryInfos(t,e),this.standardTmplCategoryInfos=this.categoryInfos.filter(function(t){return!d.has(t,"label")}),this.templateMap=this.getTemplateMap(t,e,this.categoryInfos),this.options.view.requestReactView(this.$templateListMounted,c,{canCreateTemplate:this.canCreateTemplate(),canManageTemplate:this.canManageTemplate(),categoryInfos:this.standardTmplCategoryInfos,organizationId:this._organizationId,onCreateFromTemplate:this.options.view.handleCreateFromTemplate.bind(this.options.view),onCreateSimpleProject:this.options.view.handleCreateSimpleProject.bind(this.options.view),onCreateTaskflowProject:this.options.view.handleCreateTaskflowProject.bind(this.options.view),onCreateTemplate:this.options.view.handleCreateTemplate.bind(this.options.view),templateMap:this.templateMap,canHandleTemplate:this.canHandleTemplate,onEditTemplate:this.options.view.editTemplate.bind(this.options.view),onRemoveTemplate:this.handleRemoveTemplate.bind(this)}),this.renderTemplateSidebar(),this.$templateSidebar.show()},t.prototype.canCreateTemplate=function(){var t;return null!=(t=this.options.selectedOrganizationModel)?t.hasPermission("projecttemplate.post"):void 0},t.prototype.canManageTemplate=function(){var t;return null!=(t=this.options.selectedOrganizationModel)?t.hasPermission("projecttemplate.manage"):void 0},t.prototype.handleRemoveTemplate=function(t){return this.options.view.deleteTemplate(t,(e=this,function(){return e.templates=e.templates.filter(function(e){return e._id!==t._id}),e.renderTemplates()}));var e},t.prototype.getIsOrgPro=function(){return this.selectedOrganizationModel&&u.isEnterprisePro(this.selectedOrganizationModel.payment)},t.prototype.getStandardTmplCategoryInfos=function(t,e){var o,r;return o=!t&&!this.selectedOrganizationModel&&!h.FEATURES.newOrganization,r=m(),r=(r=o?r.filter(function(t){return!t.isPro}):r).filter(function(t){return!!d.has(t,"label")||("organization"===t.category||e.filter(function(e){var o,r;return r=e.categories||[],o=t.category,k.call(r,o)>=0}).length>0)})},t.prototype.getTemplateMap=function(t,e,o){return d.reduce(o,function(t,r){var n;return n=d.filter(e,function(t){var e;return e=r.category,k.call(t.categories||[],e)>=0}),"organization"===o.category||n.length?(t[r.category]=n,t):t},{})},t.prototype.parseTemplates=function(){return d.each(this.templates,function(t){var e;return e=t.isDemo?["standard"]:t._organizationId?["organization"]:["personal"],t.categories=d.union(t.categories,e)})},t.prototype.canHandleTemplate=function(t){var e;return null!=(e=t.permissionBinding)?e.permissions.includes("projecttemplate.manage"):void 0},t.prototype.onbeforeback=function(){return this.options.keyword=void 0,!0},t.prototype.genTemplatesCategories=function(){return d.compact([{category:"standard",title:tb_i18n.get("project.creator.template.category.standard")},this._organizationId&&h.FEATURES.showTemplateCategory?{category:"organization",title:tb_i18n.get("project.creator.template.category.organization")}:void 0,h.FEATURES.showTemplateCategory?{category:"personal",deprecated:!0,title:tb_i18n.get("project.creator.template.category.personal")}:void 0])},t.prototype.handleSearchChange=function(t){var e;if(""!==(e=t.target.value.trim()))return this.options.keyword=e,this.options.view.transit(null,"goRecommendation")},t.prototype.handleInputFocus=function(){return w.gta.event({action:"type search content",control:"template list",method:"keyboard",type:"project template"})},t.prototype.remove=function(){if(this.cancelListenToTemplateList(),this.options.view.unmountReact(this.$templateSidebarMounted),this.options.view.unmountReact(this.$templateListMounted),this.projectTemplateSubscription)return this.projectTemplateSubscription.unsubscribe()},t.prototype.onClose=function(){return w.gta.event({action:"close project template",page:"Projects Page",control:"template list",method:"click"})},t}()},XcZpZJ6S:function(t,e,o){},YkUNN8dn:function(t,e,o){t.exports={"project-categories-sidebar":"project-categories-sidebar__jMbp"}},ZKkHIpWT:function(t,e,o){var r,n,i,a,s,c,l,p,u,d,h,m,g,f,v,y,b,w,j,k,T,_={}.hasOwnProperty;v=o("a+N5u/Cl"),g=o("vmWJWrVe"),T=o("sa1Ed382"),s=o("0FRv5rrl"),h=o("GESwhXbR").Toast,n=o("JopwBw83"),d=o("Xb3dMF+3"),u=o("qJcibIyM"),m=o("3PZ/ulnr").UsedTemplatesStore,r=o("9sOPw9dz"),f=o("OmupbwLD"),i=o("bZr3G77e"),y=o("gpXgy0o6").checkLimitTaskflowProjects,w=o("LISneMer"),l=w.PageHistory,c=w.Page,b=o("e8ft/Wkh").disableRecommendation,j=o("g/otyo9p"),p=j.ProjectTemplateDetailModal,a=j.Mode,k=o("R0v/qAWW"),t.exports=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return function(t,e){for(var o in e)_.call(e,o)&&(t[o]=e[o]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,g),e.prototype.viewName="ProjectCreatorView",e.prototype.className="project-creator modal-dialog",e.prototype.events={"click .fsm-action":"transit"},e.prototype.initialize=function(t){var e,o,r;return this.options=null!=t?t:{},e=b()?c.TemplateWall:c.TemplateRecommendation,o=this.options._fsm_state||e,this.options.view=this,this.options.usedTemplates=new m,this.initHistory(),this.readOrganization().then(this.getTaskflowProjects.bind(this)).then((r=this,function(){return r.renderBasic(),r.history.push(o)}))},e.prototype.initHistory=function(){return this.history=new l,this.history.on("blockPush",function(t,e){return t===this.history.anchor}),this.history.on("changed",(t=this,function(e){return t.options.history=e,t.renderState(t.history.anchor)}));var t},e.prototype.readOrganization=function(){var t,e;return(t=function(){switch(!1){case!T.PREFERENCE.isPersonalWorkspace():return null;default:return T.PREFERENCE.get("lastWorkspace")}}())?new Promise((e=this,function(o,r){return e.el?s.fetch(t,{error:r,success:function(r){var n;return(n=e.options).selectedOrganizationModel||(n.selectedOrganizationModel=r),e._organizationId=null!=r?r.id:void 0,o(t)}}):r()})):Promise.resolve()},e.prototype.getTaskflowProjects=function(t){return new Promise((e=this,function(o,r){var n;return t&&(n={_organizationId:t}),i.get("taskflow-projects",{data:n}).then(function(t){return e.options.taskflowProjects=t,o()}).catch(function(t){return r(t)})}));var e},e.prototype.pickView=function(t){return this.currentView=function(){switch(t){case c.TemplateRecommendation:return new u(this.options);case c.FromTemplate:case c.SimpleCreator:case c.TaskflowCreator:return new n(this.options);case c.TemplateWall:return new d(this.options)}}.call(this)},e.prototype.transit=function(t,e){var o,r;if(e||(e=$(t.target).data("fsm-action")),!(o=this.currentView["onbefore"+e])||o.call(this.currentView))if("go"===e&&null!=(r=this.options.selectedTemplate)&&r.alien)window.location.href=this.options.selectedTemplate.alien.url;else switch(e){case"go":return this.checkTaskflowEnabled()&&y(this.options.taskflowProjects,this.options.selectedOrganizationModel)?this.history.push(c.TaskflowCreator):this.history.push(c.FromTemplate);case"goSimple":return this.history.push(c.SimpleCreator);case"goTaskflow":return this.history.push(c.TaskflowCreator);case"goTemplateWall":return this.history.push(c.TemplateWall);case"goRecommendation":return this.history.push(c.TemplateRecommendation);case"back":return this.history.back()}},e.prototype.checkTaskflowEnabled=function(){var t;return"taskflow"===(null!=(t=this.options.selectedTemplate)?t.normalType:void 0)||"taskflow"===this.options.normalType},e.prototype.renderState=function(t){var e,o;return null!=(e=this.currentView)&&"function"==typeof e.remove&&e.remove(),o=this.pickView(t),this.$el.find(".modal-content").replaceWith(o.$el),this.undelegateEvents(),this.delegateEvents(v.extend({},o.modalEvents,this.events)),this.$el.removeClass(this._fsm_state).addClass(this._fsm_state=t),this},e.prototype.renderBasic=function(){return this.$el.html('<div class="modal-content"></div>')},e.prototype.handleCreateFromTemplate=function(t,e){var o,r,n;return r=t._id,this.options.normalType=null,this.options.usedTemplates.add(r),this.options.selectedTemplate=t,this.options.gtaControl=e,o=(n=this.options.selectedTemplate).isDemo?n.name:"organization",T.gta.event({action:"add content",type:"project",control:e,category:o,note1:n.categories[0],method:"click",project_template_algo:T.ab.getTestGroup("all","project_template_algo")}),this.transit(null,"go")},e.prototype.handleCreateTaskflowProject=function(){return this.options.normalType="taskflow",this.options.selectedTemplate=null,T.gta.event({action:"add content",type:"project",control:"template list",category:"工作流项目",note1:"blank project"}),this.transit(null,"goTaskflow")},e.prototype.handleCreateSimpleProject=function(){return this.options.normalType=null,this.options.selectedTemplate=null,T.gta.event({action:"add content",type:"project",control:"template list",category:"普通项目",note1:"blank project"}),this.transit(null,"goSimple")},e.prototype.deleteTemplate=function(t,e){var o,n,a;return n=t._id,t._organizationId?(o="organization",a=tb_i18n.get("project.creator.template.delete.org.confirm.title")):(o="personal",a=tb_i18n.get("project.creator.template.delete.my.confirm.title")),T.gta.event({action:"delete content",type:"project template",category:o}),this.requestSubView(f).open(r,{title:a,content:tb_i18n.get("project.creator.template.delete.confirm.content",t.name),confirmText:tb_i18n.get("delete"),confirmStyle:"danger",onConfirm:function(){return i.del("projecttemplates/"+n,null,{success:function(){return e(t)},error:function(){return h.error({message:tb_i18n.get("project.creator.template.delete.error")})}}),T.gta.event({action:"deleted content",type:"project template",category:o})}}),!1},e.prototype.editTemplate=function(t){return this.openTemplateEditPage(t._organizationId,t._id),!1},e.prototype.openTemplateEditPage=function(t,e){return p.open({mode:a.edit,organizationId:t,projectTemplateId:e}),T.gta.event({action:"to edit content",type:"project template",category:"organization"})},e.prototype.handleCreateTemplate=function(){return this.openTemplateCreator(this._organizationId)},e.prototype.openTemplateCreator=function(t){return p.open({mode:a.create,organizationId:t}),T.gta.event({action:"to add content",category:"organization"}),this},e.prototype.close=function(){var t;return null!=(t=this.parentView)&&t.remove(),this},e.prototype.onClose=function(){var t,e;return null!=(t=this.currentView)&&"function"==typeof t.remove&&t.remove(),null!=(e=this.currentView)&&"function"==typeof e.onClose&&e.onClose(),k.searchTemplate.clearCache(),this},e}()},aePTiwey:function(t,e,o){var r,n,i,a,s,c,l,p,u,d,h,m=function(t,e){return function(){return t.apply(e,arguments)}},g={}.hasOwnProperty;p=o("a+N5u/Cl"),s=o("vmWJWrVe"),i=o("iSsLT+9z"),h=o("tLZJUYWX"),a=o("eubUSX4T"),c=o("5CiSxGri"),l=o("WRIFfSP1"),n=o("bFM+GwEk"),r=$(window),d=o("G8QA1dk+"),u={tabIndent:!1,toolbarFloat:!1,toolbar:["title","bold","italic","underline","strikethrough","color","|","ol","ul","blockquote","code","indent","outdent","alignment","|","link","upload","hr","table"]},t.exports=function(t){function e(){return this.insertImageById=m(this.insertImageById,this),e.__super__.constructor.apply(this,arguments)}return function(t,e){for(var o in e)g.call(e,o)&&(t[o]=e[o]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,s),e.prototype.viewName="PostEditorView",e.prototype.className="post-editor",e.prototype.tagName="section",e.prototype.initialize=function(t){return this.options=t,this._projectId=t._projectId,this.attachments=t.attachments||new a,this.renderBasic(),this.initSimditor(),this.renderAttachments(),this.listen()},e.prototype.listen=function(){var t;return this.listenTo(this.attachments,"remove add",this.renderAttachments),this.listenTo(this.attachments,"add change:completed",(t=this,function(e,o){if(o)return t.insertImage(e)})),this.editor.off(".post-editor"),this.editor.on("valuechanged.post-editor",function(t){return function(e){var o;return"function"==typeof(o=t.options).onchange&&o.onchange(t.get()),t.checkFixed()}}(this)),this.editor.on("uploadclick.post-editor",function(t){return function(e){return t.toggleWorksPicker(e)}}(this)),r.off("resize.post-editor"),r.on("resize.post-editor",function(t){return function(e){return t.calculateWith(e)}}(this))},e.prototype.renderBasic=function(){return this.$el.html(n({content:this.options.content})),this.$editorBarWrap=this.$(".editor-bar-wrap"),this.$textarea=this.$(".editor-input"),this.$attachmentsWrap=this.$(".editor-attachments")},e.prototype.initSimditor=function(){var t;return d.setup(),t=p.extend(u,this.options,{textarea:this.$textarea[0],placeholder:h.get("wall.view.post.creator.placeholder")}),this.editor=new i(t),this.editor.body.addClass("readable")},e.prototype.renderAttachments=function(){return this.$attachmentsWrap.empty(),this.attachments.each((t=this,function(e){return t.addAttachment(e)}));var t},e.prototype.addAttachment=function(t){var e;return e=this.$attachmentsWrap,this.requestSubView(c,{workModel:t,thirdtitle:!0,onInsertImage:this.insertImageById}).$el.prependTo(e)},e.prototype.removeAttachment=function(t){return this.$attachmentsWrap.find("li[data-cid="+t.cid+"]").remove()},e.prototype.setProjectId=function(t){return this._projectId=t},e.prototype.toggleWorksPicker=function(t){var e;if(!this.worksPicker||this.worksPicker._projectId!==this._projectId)return null!=(e=this.worksPicker)&&e.remove(),this.worksPicker=this.requestSubView(l,{container:this.$el,_projectId:this._projectId,collection:this.attachments,$toggler:this.$(".toolbar-item-upload"),placement:"bottom"})},e.prototype.saveCaretPos=function(){return this.caretPos=this.$textareaset[0].selectionStart,this},e.prototype.insertImageById=function(t){return this.insertImage(this.attachments.get(t))},e.prototype.insertImage=function(t,e){var o;if(o=this.getPreviewUrl(t))return this.editor.toolbar.findButton("upload").insertImage(o,t.get("fileName")),this},e.prototype.refreshImage=function(t){var e,o,r;if(this.getPreviewUrl(t))return o=t.previous("thumbnailUrl"),r=this.getPreviewUrl(t),e=t.get("fileName"),o&&r?(this.$("img").each(function(){if(this.src===o)return $(this).attr({src:r,alt:e,title:e})}),this.set(this.editor.body.html())):void 0},e.prototype.getPreviewUrl=function(t){var e,o,r,n,i;if(t)return n=t.get("thumbnailUrl")||"",i=t.get("imageWidth"),e=t.get("imageHeight"),r=i<400?200:i<600?400:i<800?600:800,o=Math.ceil(r*e/i),n=n.replace("w/200/h/200","w/"+r+"/h/"+o)},e.prototype.checkFixed=function(){var t,e;return(e=(t=this.$(".simditor-toolbar")).parent()[0])&&e.getBoundingClientRect().top<0?(t.addClass("on-fixed"),this.calculateWith()):t.removeClass("on-fixed").removeAttr("style")},e.prototype.calculateWith=function(){var t,e;if((t=this.$(".simditor-toolbar")).hasClass("on-fixed"))return e=this.$el.width(),t.width(e)},e.prototype.get=function(){return this.editor.getValue()},e.prototype.set=function(t){return this.editor.setValue(t),this},e.prototype.focus=function(){return this.editor.focus(),this},e.prototype.remove=function(){return r.off("resize.post-editor"),this.$el.off(),this.editor.destroy(),e.__super__.remove.apply(this,arguments)},e}()},"bFM+GwEk":function(t,e){t.exports=function(t){var e,o;return'<section class="editor-content-wrap"> <textarea class="editor-input" autofocus>'+("undefined"!=typeof _encodeHTML?_encodeHTML:(e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},o=/&(?!#?\w+;)|<|>|"|'|\//g,function(t){return t?t.toString().replace(o,function(t){return e[t]||t}):""}))(t.content)+'</textarea></section><footer> <ul class="editor-attachments clearfix"></ul></footer>'}},"d72Xq/Gk":function(t,e,o){"use strict";o.d(e,"a",function(){return p});var r=o("q1tIBJhx"),n=o.n(r),i=o("TSYQbtd+"),a=o.n(i),s=o("9l7jY84A"),c=o("9Epak9CN"),l=o.n(c),p=function(t){return n.a.createElement(s.a,{className:a()(l.a["loading-card"],t.className)},n.a.createElement("div",{className:"loading-card__shadow"}))}},ddZQdkn8:function(t,e,o){t.exports=function(t){var e,r,n="undefined"!=typeof _encodeHTML?_encodeHTML:(e={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},r=/&(?!#?\w+;)|<|>|"|'|\//g,function(t){return t?t.toString().replace(r,function(t){return e[t]||t}):""}),i="",a=o("90U+kJWN"),s=a.UNIQUE_ID_PREFIX_MIN_LENGTH,c=a.UNIQUE_ID_PREFIX_MAX_LENGTH;return i+='<form class="form-create-project form-horizontal"> <header class="modal-header text-center"> ',t.showBackButton&&(i+=' <a class="pull-left icon icon-chevron-left fsm-action" data-fsm-action="back"></a> '),i+=' <h4 class="modal-title">'+t.title+'</h4> <a class="modal-close pull-right icon icon-remove" data-dismiss="modal"></a> </header> <div class="modal-body text-center flex-horiz ',t.isProTemplate&&(i+=" pro "),i+='"> <section class="template-overview flex-space flex-vert"></section> <section class="creator-content flex-space flex"> ',t.isDisabled?(i+='  <div class="project-template-upragde-promotion flex-space flex flex-vert"> <section class="flex-space flex-vert flex-center flex-vcenter"> <div class="upgrade-illustration"></div> <p class="upgrade-hint"> '+tb_i18n.get("project.creator.template.upgrade.pro",_.escape(t.selectedTemplate.name))+" </p> \x3c!-- FIXME add href here <a>"+tb_i18n.get("learn.more")+"</a> --\x3e </section> ",t.isProTemplate&&(i+='  <button class="btn btn-primary btn-upgrade-to-pro-org" data-pay="'+t.payProtocol+'" > '+tb_i18n.get("project.creator.template.upgrade.pro.upgrade")+" </button> "),i+=" </div> "):(i+='  <div class="creator-content-container flex-fill flex-vert">  ',t.isProTemplate||(i+=' <p class="intro"> '+tb_i18n.get("project.creator.template.intro",_.escape(t.selectedTemplate.name))+" </p> "),i+=' <div class="item-section"> ',t.isProTemplate&&(i+=" <h5>"+tb_i18n.get("project.name")+"</h5> "),i+=' <div class="form-group"> <input class="project-name form-control" value="'+n(t.selectedTemplate.name)+'" placeholder="'+tb_i18n.get("project.creator.porject.name.placeholder")+'"> </div> </div> <div class="project-section"> <h5>'+tb_i18n.get("project.categories")+" ("+tb_i18n.get("is.multiple.choice.able")+')</h5> <div class="form-group"> <div class="open-selector-handler form-control is-placeholder"> <div class="selector-title"></div> <span class="icon icon-chevron-down icon-on-bar"></span> </div> </div> </div> ',t.showUniqueIdPrefix&&(i+='  <div class="item-section"> <h5>'+tb_i18n.get("project.creator.template.unique.id.prefix.title")+'</h5> <div class="form-group"> <input class="project-unique-id-prefix form-control" placeholder="'+tb_i18n.get("project.creator.template.unique.id.prefix.placeholder",s,c)+'" value="'+t.uniqueIdPrefix+'" > <p class="project-unique-id-prefix-error"> <span class="icon icon-circle-remove"></span> <span class="project-unique-id-prefix-error-text"></span> </p> </div> </div> '),i+=" ",t.isProTemplate&&(i+=' <div class=\'submit-wrap-pro\'>  <button type="submit" class="btn btn-primary btn-create-project ',t.isProTemplate&&(i+=" btn-block "),i+='" > <span>'+tb_i18n.get("project.creator.template.create")+"</span> </button> </div> "),i+=" </div> "),i+=" </section> </div> ",t.isProTemplate||(i+=' <div class="modal-footer flex-static"> ',t.isDisabled?i+='  <button class="btn btn-primary btn-upgrade-to-pro-org" data-pay="'+t.payProtocol+'" > '+tb_i18n.get("project.creator.template.upgrade.pro.upgrade")+" </button> ":(i+='  <button type="submit" class="btn btn-primary btn-create-project ',t.isProTemplate&&(i+=" btn-block "),i+='" > <span>'+tb_i18n.get("project.creator.template.create")+"</span> </button> "),i+=" </div> "),i+="</form>"}},"e8ft/Wkh":function(t,e,o){"use strict";o.r(e),o.d(e,"genStandardTemplateCategoryInfos",function(){return h}),o.d(e,"isNewTemplate",function(){return m}),o.d(e,"disableRecommendation",function(){return g});var r=o("tLZJUYWX"),n=o("suI5NDUm"),i=o("2qRnoGmE"),a=o.n(i),s=o("sa1Ed382"),c=o("wd/RKGTj"),l=o.n(c),p=o("L+U0RKxI").isInternational,u=[{icon:"org-projects",category:"blank",get name(){return r.get("project.creator.template.category.blank")},isPro:!1},{icon:"building",category:"organization",get name(){return r.get("project.creator.template.category.organization")},isPro:!1},{get label(){return r.get("project.creator.template.choose.category")}},{icon:"earth",category:"rd",get name(){return r.get("project.creator.template.category.rd")},isPro:!1},{icon:"briefcase-stroke",category:"marketing",get name(){return r.get("project.creator.template.category.marketing")},isPro:!1},{icon:"computer",category:"operations",get name(){return r.get("project.creator.template.category.operations")},isPro:!1},{icon:"salesman",category:"salesservice",get name(){return r.get("project.creator.template.category.salesservice")},isPro:!1},{icon:"travel",category:"engineering",get name(){return r.get("project.creator.template.category.engineering")},isPro:!1},{icon:"human",category:"education",get name(){return r.get("project.creator.template.category.education")},isPro:!1},{icon:"stationery",category:"manufacturing",get name(){return r.get("project.creator.template.category.manufacturing")},isPro:!1},{icon:"circle-infinite",category:"industry",get name(){return r.get("project.creator.template.category.industry")},isPro:!1},{icon:"clothes",category:"arrangement",get name(){return r.get("project.creator.template.category.arrangement")},isPro:!1}],d=[{icon:"org-projects",category:"blank",get name(){return r.get("project.creator.template.category.blank")},isPro:!1},{icon:"building",category:"organization",get name(){return r.get("project.creator.template.category.organization")},isPro:!1},{icon:"pre",category:"aone",get name(){return r.get("project.creator.template.category.rd")},isPro:!1},{icon:"palette",category:"rd",get name(){return r.get("project.creator.template.category.design")},isPro:!1},{icon:"briefcase-stroke",category:"marketing",get name(){return r.get("project.creator.template.category.marketing")},isPro:!1},{icon:"computer",category:"operations",get name(){return r.get("project.creator.template.category.operations")},isPro:!1},{icon:"salesman",category:"salesservice",get name(){return r.get("project.creator.template.category.salesservice")},isPro:!1},{icon:"travel",category:"engineering",get name(){return r.get("project.creator.template.category.engineering")},isPro:!1},{icon:"human",category:"education",get name(){return r.get("project.creator.template.category.education")},isPro:!1},{icon:"stationery",category:"manufacturing",get name(){return r.get("project.creator.template.category.manufacturing")},isPro:!1},{icon:"circle-infinite",category:"industry",get name(){return r.get("project.creator.template.category.industry")},isPro:!1},{icon:"clothes",category:"arrangement",get name(){return r.get("project.creator.template.category.arrangement")},isPro:!1}];function h(){return n.isAone()?d.slice():u.slice()}function m(t,e){var o=l()(),r=l()(t.updated),n=!e.has(t._id);return o.diff(r,"d")<=5&&n&&t.isDemo}function g(){return[a.a.FREE,!s.PREFERENCE.get("collectBehaviorLogs"),p()].some(function(t){return t})}},eL7ZptkA:function(t,e,o){var r={"./simple":"XXqLhmuA","./simple.html":"XXqLhmuA","./template":"ddZQdkn8","./template-overview":"8nlPGZpY","./template-overview.html":"8nlPGZpY","./template.html":"ddZQdkn8"};function n(t){var e=i(t);return o(e)}function i(t){if(!o.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}n.keys=function(){return Object.keys(r)},n.resolve=i,t.exports=n,n.id="eL7ZptkA"},g8vSXgFG:function(t,e,o){},"guka/Ad6":function(t,e,o){"use strict";o.r(e),o.d(e,"getBlankTemplate",function(){return i});var r=o("tLZJUYWX"),n=o("uHRdHWpl"),i=function(t){var e,o=(e=Object(n.default)("2019-01-02").add(30,"day").endOf("day"),Object(n.default)().isBefore(e));switch(t){case"standard":return[{_id:"template-creator-simple",name:r.get("blank.project.simple.name"),description:r.get("blank.project.simple.description"),isBlank:!0,categories:["blank"]},{_id:"template-creator-taskflow",name:r.get("blank.project.taskflow.name"),description:r.get("blank.project.taskflow.description"),categories:["blank"],isBlank:!0,isPro:!1,isNew:o}];case"organization":return[{_id:"org-template-creator",name:r.get("project.creator.org.template.creator.name"),description:r.get("project.creator.org.template.creator.description"),isBlank:!0},{_id:"org-template-creator-taskflow",name:r.get("project.creator.org.template.creator.taskflow.name"),description:r.get("project.creator.org.template.creator.taskflow.description"),isBlank:!0,isPro:!1,isNew:o}]}return[]}},ki3qbJ4Q:function(t,e,o){t.exports=o.p+"images/agile-test.dc7804a9.png"},qJcibIyM:function(t,e,o){var r;o("vmWJWrVe"),r=o("e8ft/Wkh").isNewTemplate,o("XcZpZJ6S"),t.exports=function(){function t(t){this.options=null!=t?t:{},this.$el=$('<div class="modal-content"></div>'),this.usedTemplates=this.options.usedTemplates,this.render()}return t.prototype.render=function(){var t,e;return t=$('<div class="template-recommendation-view"></div>'),this.options.view.showLoadingIndicator(t),this.mountNode=t[0],this.$el.html(t),o.e(39).then((e=this,function(t){var r;return r=o("ZoxGTitg").TemplateRecommendationContainer,e.options.view.requestReactView(e.mountNode,r,{isNew:e.isNew.bind(e),keyword:e.options.keyword,onShowAll:function(){return e.options.view.transit(null,"goTemplateWall")},onBack:function(){return e.options.view.transit(null,"back")},onCreateFromTemplate:e.options.view.handleCreateFromTemplate.bind(e.options.view),onCreateSimpleProject:e.options.view.handleCreateSimpleProject.bind(e.options.view),onCreateTaskflowProject:e.options.view.handleCreateTaskflowProject.bind(e.options.view),onCreateTemplate:e.options.view.handleCreateTemplate.bind(e.options.view),templateMap:e.templateMap,canHandleTemplate:e.canHandleTemplate,canCreateTemplate:e.canCreateTemplate(),onEditTemplate:e.options.view.editTemplate.bind(e.options.view),onRemoveTemplate:e.handleRemoveTemplate.bind(e)})}).bind(null,o)).catch(o.oe)},t.prototype.handleRemoveTemplate=function(t,e){return this.options.view.deleteTemplate(t,e)},t.prototype.canHandleTemplate=function(t){var e;return null!=(e=t.permissionBinding)?e.permissions.includes("projecttemplate.manage"):void 0},t.prototype.canCreateTemplate=function(){var t;return null!=(t=this.options.selectedOrganizationModel)?t.hasPermission("projecttemplate.post"):void 0},t.prototype.isNew=function(t){return r(t,this.usedTemplates)},t.prototype.onbeforeback=function(){return this.options.keyword=void 0,!0},t.prototype.onbeforegoTemplateWall=function(){return this.options.keyword=void 0,!0},t.prototype.remove=function(){return this.options.view.unmountReact(this.mountNode)},t}()},uZT221n9:function(t,e,o){"use strict";o.r(e),o.d(e,"ProjectCategoryItem",function(){return d}),o.d(e,"ProjectCategoriesSidebar",function(){return h});var r=o("mrSGxOB2"),n=o("a+N5u/Cl"),i=o.n(n),a=o("q1tIBJhx"),s=o.n(a),c=o("TSYQbtd+"),l=o.n(c),p=o("GESwhXbR"),u=o("YkUNN8dn"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onChangeCategory=function(){var t=e.props,o=t.projectCategoryInfo;(0,t.onChangeCategory)(o.category)},e}return r.d(e,t),e.prototype.render=function(){var t=this.props,e=t.projectCategoryInfo,o=t.actived,r=t.count,n=l()("project-category-item",{actived:o});return s.a.createElement("div",{className:n,onClick:this.onChangeCategory},s.a.createElement("div",{className:"category-icon-wrap"},s.a.createElement(p.Icon,{name:e.icon})),s.a.createElement("div",{className:"category-desc"},e.name),!i.a.isUndefined(r)&&s.a.createElement("div",{className:"category-count"},r))},e}(s.a.Component),h=function(t){function e(e){return t.call(this,e)||this}return r.d(e,t),e.prototype.isLabel=function(t){return i.a.has(t,"label")},e.prototype.renderLabel=function(t){return s.a.createElement("div",{key:t,className:"project-category-list-title"},t)},e.prototype.renderCategoryList=function(){var t=this,e=this.props,o=e.projectCategoryInfos,r=e.currentCategory,n=e.onChangeCategory,i=e.templateMap,a=o.map(function(e){if(t.isLabel(e))return t.renderLabel(e.label);var o=i[e.category];return s.a.createElement(d,{key:e.category,projectCategoryInfo:e,actived:e.category===r,onChangeCategory:n,count:o&&o.length})});return s.a.createElement("div",{className:"project-category-list"},a)},e.prototype.render=function(){return s.a.createElement("div",{className:u["project-categories-sidebar"]},this.renderCategoryList())},e}(s.a.Component)}}]);
//# sourceMappingURL=14.30708cb3.chunk.js.map